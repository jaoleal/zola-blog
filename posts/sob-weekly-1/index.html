<!doctype html><html class="not-ready lg:text-base" lang=en><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><title>
    SoB weekly report! - 錆 Blog
  </title><meta name=theme-color><meta content="SoB weekly report!" name=description><meta content="SoB weekly report!" name=author><link rel="preload stylesheet" as=style href=https://jaoleal.github.io/zola-blog/main.css><style>:root {--bg:#dcd7c9;--bg-dark:#3f4e4f;--header:#e4e4e7;--header-dark:#27272a}</style><link as=image href=https://jaoleal.github.io/zola-blog/icons/theme.svg rel=preload><link href=https://jaoleal.github.io/zola-blog/favicon16x16.png rel=icon type=image/x-icon><link href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-1/ rel=canonical><body class="text-black duration-200 ease-out dark:text-white"><header class="blur-header fixed top-0 z-40 mx-auto min-h-[3.5rem] w-full"><div class="mx-auto w-full max-w-4xl p-3 lg:flex lg:justify-between"><div class="flex justify-between"><div class="flex items-center"><a class="text-2xl font-semibold" href=https://jaoleal.github.io/zola-blog>錆 Blog</a><div class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] [background:url(./icons/theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]" aria-label=Dark role=button></div></div></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu?.addEventListener("click",()=>{htmlClass.toggle("open")});const setDark=a=>{htmlClass[a?"add":"remove"]("dark");localStorage.setItem("dark",a)};const darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark")){setDark(true)}else{const a=localStorage.getItem("dark");setDark(a?a==="true":darkScheme.matches)};darkScheme.addEventListener("change",a=>{setDark(a.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-4 pb-16 pt-32 dark:prose-invert"><article><header class=mb-16><h1 class="!my-0 pb-2.5">SoB weekly report!</h1><div class="text-sm antialiased opacity-60"><time>2024-06-11</time><span class=mx-1>·</span><span>7min</span><span class=mx-1>·</span><span>João Leal</span></div></header><section><p>So, Summer of Bitcoin, the reason for my lack of sleep in the past month.</p><iframe allowfullscreen class=giphy-embed frameborder=0 height=271 src=https://giphy.com/embed/udoce5CHY5kZSY031S width=480></iframe><p><a href=https://giphy.com/gifs/ThisIsMashed-animation-animated-mashed-udoce5CHY5kZSY031S>via GIPHY</a><p>In short words, there are some college programs of computer science that take the “summer” time of students to get’em to work and try to help them to enter the programming industry… We really need this help, after the pandemics and the six months courses that just spammed made the junior entry kinda bloated with some rookies that learned to write some code on <strong>python</strong> or <strong>yavascript</strong> and are trying to find a job. That's not my case for a bunch of reasons (Web Development never was my thing by example), anyway, just some bs that i have to complain about because a lot of people got fooled by those courses.<p>Summer of Bitcoin follows the same logic as the “Summer” programs:<ol><li>Pass a test<li>Work in a project<li>win money<li>get referred to a job</ol><p>Because this is a weekly and technical blog post about my work on Floresta, I'll share my personal experience another day… But was and is currently being just <strong>awesome</strong>.<p>QUICK TECHNOLOGY CONCEPTS RESUME!<br><ul><li><p>Floresta, a full bitcoin node built in rust that uses Utreexo for validation.</p><li><p>Utreexo is a merkle-tree based accumulator designed to store bitcoin chainstate.</p><li><p>Rust is a programming language.</p><li><p>Bitcoin is Bitcoin.</p></ul><p>So, a brief story about rust and its Async-Runtime: <strong>nuh huh</strong>. Exactly, it does not have one but, a good language needs parallelism (I'd love to talk about parallelism) and the Rust foundation let this job for the community, helped with some types and traits(something like interfaces in c#), but, at the end, the <strong>Rust language</strong>, theoretically, does not have a specific Async-Runtime. That causes some performance and behavior differences on the code execution while using async at all, that was the case for Floresta that is actually using Async-std that loses in popularity and performance to tokio(Another Async-Runtime). With that said, one of the ideas that, <a href=https://github.com/Davidson-Souza>Davidson</a> (Maintainer of the Floresta) had proposed to us, interns, was the change of the Async-std to Tokio and i tried to propose for that idea, made a proposal and got accepted. But, the maintainer has more important things to implement at floresta: The Consensus Rules.<p><strong>Bitcoin</strong> works with blocks “in a linked list” that movement the transactions and change the chainstate but, its decentralization requires that everyone agree with the protocol, this protocol is the consensus rules that i mentioned earlier and its organized in “bips” at the bitcoin repository(a bip is added there when it's approved by the community with some kind of democracy that i don't know so much about to tell you). With that knowledge, I need to map which rules floresta already has and which don't, implement them and add some test batteries so we can ensure that floresta will never validate a wrong block.<blockquote><p>Why is that important ? even if the floresta node validates a wrong block the whole chain will deny it, right ?</blockquote><p>Very clever my guy, but nothing stops someone in the future who wants, for any reason, to create a whole blockchain for itself(like some web3 shit) with just florestas, remember that floresta is made to be cheap to run ? (Pretend that i told you that) With some very good tweaks floresta can be even cheaper than already is compared to bitcoin OG node, I will make another blog post talking specifically about floresta and its technologies, and if i didn't even implement the basics of the project is like: <strong>“What the fuck are we doing?!?”</strong><p>There’s no point in making bad software, like everything made in nodejs.<p>Truths apart, after some reading at the bitcoin core and at the floresta codebase, here’s the map about the consensus rules:<ul><li><p>In block transaction structure validation. ( Verifies if it has, at least, one transaction per block, if it has coinbase, etc...)</p><li><p>Script validation. (by libbitcoin)</p><li><p>PrevOut validation. (If it has a valid PrevOut).</p><li><p>The lacking Rules are:</p></ul><ol><li><p>Values validation.</p><li><p>Output value is equal or less than total input (Implemented, just needs tests).</p><li><p>None of the values is negative.</p><li><p>Any value cannot be greater than the number in satoshis of the maximum possible bitcoins. (MAX_MONEY = 21000000 * 100 000 000).</p><li><p>Double Input Spend. (The case that has more than one equal input, mostly referring to the same utxo)</p><li><p>Inputs are spent, exactly, the declared satoshis including fee and UTXO’s.</p><li><p>Size validation</p><li><p>no more than 80000 sigops.</p><li><p>ScriptPubKey Size has to be >2 and &LT520 bytes if coinbase, scriptSig has to be >2 and &LT100 bytes, unless it's taproot, in that case the scriptsig has no limits</p><li><p>Absolute and Relative Locktimes defined by sequence. In regards to transactions, that’s it(And you can see more on the draft that I`m building, there’s the place where I maintain everything updated: <a href=https://github.com/Davidson-Souza/Floresta/pull/165>Transactions Consensus Rules</a>). But now, blocks rules:</p></ol><p>The block header consist on(in this order):<ul><li><p>Version</p><li><p>Previous Block Hash</p><li><p>Merkle Root</p><li><p>TimeStamp</p><li><p>Bits</p><li><p>Nonce</p><li><p>Txcount</p></ul><ol><li>First Tx has to be a coinbase<li>Coinbase needs a witness commitment<li>Coinbase value is, exactly, bitcoin prize (can vary at the time that’s calculated) + accumulated fee<li>Tx’s has to be ordered in chronological order<li>Size has to be valid (not more, but less than 4 000 000 vbytes).</ol><p>May be it, one or another rule can appear and you can check the actual progress in this <a href=https://github.com/Davidson-Souza/Floresta/pull/165>Transactions Consensus Rules</a><blockquote><p>And how we are sure that we implemented the rules right ?</blockquote><p>We just have to test it with the bitcoin core’s test battery that’s built in python but we can implement it on both Rust and python.<p>To enter the test topic with the right thoughts i want to introduce another project that is related to Vinteum org:<p>Bitcoin fuzz maintained by <a href=https://github.com/brunoerg>Bruno Garcia</a>, the vinteum’s director of education, he’s a cool guy but let’s talk about his project and literally repeating what he said to me, Bitcoin Fuzz generate a bunch of bitcoin related data and smashes the target project with them, with this you can find a lot of bugs… hope that became a standard on the bitcoin environment, that lil’dude(The project, not bruno) can give you more than 100% test coverage and ensures that your bitcoin related project is doing exactly what you want and we three: me, bruno and davidson are talking a long time about using it on floresta! The fuzzing will be at the end of the whole project because we have some other tests to implement together with the consensus rules: Functional and Unitary on Rust and the bitcoin core(related to consensus obviously).<p>Phew That's it! Hope next week I can bring more technical details for y’all, the project is walking slowly at the end of march and beginning of june because of my college, the end of semester is full of activities and some recaps that i need to do with some colleagues. Until (approximately) next week!</section><hr><footer class="mt-12 flex flex-col"><div class="mb-2 flex flex-wrap"><span class="block-bg mb-1.5 mr-1.5 rounded-lg px-5 py-1.5">Tags </span><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/blog-post/>blog post</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/summer-of-bitcoin/>Summer of Bitcoin</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/work/>Work</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/floresta/>Floresta</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/rust/>Rust</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/bitcoin/>Bitcoin</a></div></footer><nav class="block-bg mt-12 flex rounded-lg text-lg"><a class="block-hover-mask flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline" href=https://jaoleal.github.io/zola-blog/posts/hi-names-jao/><span class=mr-1.5>←</span><span>Hi, name's Jao!</span></a><a class="block-hover-mask ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline" href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-2/><span>SoB weekly 2!</span><span class=ml-1.5>→</span></a></nav></article></main><footer class="mx-auto flex max-w-3xl flex-wrap items-center px-8 py-4 text-sm opacity-60"><div class="mr-auto basis-full lg:basis-1/2">© 2024 <a class=link href=https://jaoleal.github.io/zola-blog>João Leal</a></div><div class="flex basis-full lg:basis-1/2 lg:justify-end"><a class="link mr-6 lg:ml-6" href=https://www.getzola.org/ rel=noopener target=_blank>Powered by Zola</a><a class=link href=https://github.com/st1020/kita rel=noopener target=_blank>✎ Kita</a></div></footer>