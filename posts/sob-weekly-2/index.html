<!doctype html><html class="not-ready lg:text-base" lang=en><head><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><title>
    SoB weekly 2! - 錆 Blog
  </title><meta name=theme-color><meta content="SoB weekly 2!" name=description><meta content="SoB weekly 2!" name=author><link rel="preload stylesheet" as=style href=https://jaoleal.github.io/zola-blog/main.css><style>:root {--bg:#dcd7c9;--bg-dark:#3f4e4f;--header:#e4e4e7;--header-dark:#27272a}</style><link as=image href=https://jaoleal.github.io/zola-blog/icons/theme.svg rel=preload><link href=https://jaoleal.github.io/zola-blog/favicon16x16.png rel=icon type=image/x-icon><link href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-2/ rel=canonical><body class="text-black duration-200 ease-out dark:text-white"><header class="blur-header fixed top-0 z-40 mx-auto min-h-[3.5rem] w-full"><div class="mx-auto w-full max-w-4xl p-3 lg:flex lg:justify-between"><div class="flex justify-between"><div class="flex items-center"><a class="text-2xl font-semibold" href=https://jaoleal.github.io/zola-blog>錆 Blog</a><div class="btn-dark ml-4 h-6 w-6 shrink-0 cursor-pointer text-[0] [background:url(./icons/theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]" aria-label=Dark role=button></div></div></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu?.addEventListener("click",()=>{htmlClass.toggle("open")});const setDark=a=>{htmlClass[a?"add":"remove"]("dark");localStorage.setItem("dark",a)};const darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark")){setDark(true)}else{const a=localStorage.getItem("dark");setDark(a?a==="true":darkScheme.matches)};darkScheme.addEventListener("change",a=>{setDark(a.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-4 pb-16 pt-32 dark:prose-invert"><article><header class=mb-16><h1 class="!my-0 pb-2.5">SoB weekly 2!</h1><div class="text-sm antialiased opacity-60"><time>2024-07-25</time><span class=mx-1>·</span><span>5min</span><span class=mx-1>·</span><span>João Leal</span></div></header><div class="block-bg mb-12 flex rounded-lg p-2 text-lg"><details><summary class="cursor-pointer py-1 pl-4"><span>Table of Contents</span></summary> <div class=px-2><ul><li><a class="no-underline hover:underline" href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-2/#transaction-rules>Transaction Rules</a><li><a class="no-underline hover:underline" href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-2/#after-that>After that</a></ul></div></details></div><section><p>So, Almost a month has passed since the last post about my internship... *sorry meme gif Worth Waiting but here some quick updates:<ul><li><p>The Transaction Rules PR was merged! Floresta now validates all the transaction rules but the timelock and sequence one. This was a regression, but has a good reason. Read More Here.</p><li><p>Now working on the Block Rules PR. This one is a bit more complex right because it involves a <em>Desing Change</em> on <code>Floresta-Chain</code>. Read more here.</p></ul><h2 id=transaction-rules>Transaction Rules</h2><p>So, Transactions exist to address value to another owner, we use for more things nowaday but it structure was develop to reach this purpose. To make a transaction, we take our address with value, specify the value reserving a fee for the miner, tell the receiver address, prove that the spending address is ours and wait for the transaction to be included on some block.<p>I'll superficially pass trough this steps explaining the rules that they have to accomplish.<p><strong>Addresses with value</strong> are called <code>Unspent Transaction Ouptut</code> or shortly <code>UTXO</code>, everytime that we use an address we burn it and never use it anymore, right because its easier and safer to validate like this(and a wallet can have a bunch of them, like a lot). Actually you can let some value on a used address(if you hand-write your transaction) but any Node will not agree that it can be used again so we can shorten the <code>ChainState</code> storage and ensure the exposed data while publishing the transaction offers no risk to us, people that are making transactions. The Rule for it is simple, if its the second time that were seeing te same <code>UTXO</code> as a input the node can consider it valid.<blockquote><p>Yes, second time, it was a output before! <code>Outputs</code> that has any value became a <code>Input</code> while spending, beeing called a <code>UTXO</code> until spent.</blockquote><p><code>Floresta</code> uses <code>Utreexo</code> to store the <code>ChainState</code>(all the <code>UTXO</code>s available in the blockchain), <code>Utreexo</code> being a accumulator of <code>UTXO</code>s we simply remove the spending <code>UTXO</code> from it. If any transactions tries to spend it again we'll not find it. Invalidating the input and the whole transaction.<p>The values logic are simple, you cannot spend more than the value included on inputs and the more you reserve for miners faster you transaction will be included in a block(If too low your coins will be stuck, but we already have a way to solve this using sequences and timelocks).<p>So we can assert that the <code>Spending Address</code>(Input or UTXO for now on) belong to someone thats trying to spend the address, we have a mini script language amazingly called <strong>Bitcoin Script</strong> (The bitcoin comunitty is not good with names) the language is intentionally not <a href=https://en.wikipedia.org/wiki/Turing_completeness>Turing Complete</a> for safety reasons, but it more than enough to prove to someone that you have certain secret without reveling it, this secret being the private key that corresponds the bitcoin address.<blockquote><p>See <a href=https://learnmeabitcoin.com/beginners/guide/keys-addresses/>Keys & Addresses</a> by Greg Walker.</blockquote><p><strong>Bitcoin Script</strong> have it constraints too, so we have to validate it. The script is present on two camps across a transaction: <code>ScriptSig</code> and <code>ScriptPub</code>. You can think of <code>ScriptPub</code> as a lock and the <code>ScriptSig</code> as a key, anyone has access to both, but only the owner of the address can generate and insert the valid <code>ScriptSig</code> for the corresponding Addres, <code>Bitcoin Script</code> was developed with this functionality in mind, regards its use for a lot of things like <a href=https://realeinherjar.github.io/2023-09-08-taproot/><code>TapRoot</code></a>.<p>Enough explanation, the constraints about the <code>Bitcoin Script</code>:<ul><li><p>Besides <code>Taproot</code>, it cannot have more than 520 bytes of lenght.</p><li><p>And cannot do more than 80_000 <a href=https://bitcoin.stackexchange.com/questions/117356/what-is-sigop-signature-operation>Signature Operation</a>.</p></ul><p>For a transaction be valid, all of them has to be executed and validated, but since reimplement all of the <code>Bitcoin Script</code> can carry a lot of bugs, we use the <a href=https://github.com/rust-bitcoin/rust-bitcoin><code>Rust-Bitcoin</code></a>`s implementation that seems to be more than enough.<p>After that, the camps that still needs some validation is <a href=https://learnmeabitcoin.com/technical/transaction/locktime/><code>Locktime</code></a> and <a href=https://learnmeabitcoin.com/technical/transaction/input/sequence/><code>Sequence</code></a>, but its implementation got blocked because we need the <code>Median Time Past</code> of the block and Floresta doesnt offer that info so easily, me and the mentor of the project agreed to let this validation be a separate PR and i will talk about it in a dierent blog post because it includes the asynchronous block validation of Floresta.<h2 id=after-that>After that</h2><p>I still need to work on block validation, which is a little bit easier, this blog post is already enough for the " WeEKlY UpDATe " now you are apart of my work so far! Hope that you, reader, liked this post. Thanks for reading!</section><hr><footer class="mt-12 flex flex-col"><div class="mb-2 flex flex-wrap"><span class="block-bg mb-1.5 mr-1.5 rounded-lg px-5 py-1.5">Tags </span><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/blog-post/>blog post</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/summer-of-bitcoin/>Summer of Bitcoin</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/work/>Work</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/floresta/>Floresta</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/rust/>Rust</a><a class="block-bg block-hover mb-1.5 mr-1.5 rounded-lg px-5 py-1.5 no-underline" href=https://jaoleal.github.io/zola-blog/tags/bitcoin/>Bitcoin</a></div></footer><nav class="block-bg mt-12 flex rounded-lg text-lg"><a class="block-hover-mask flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline" href=https://jaoleal.github.io/zola-blog/posts/sob-weekly-1/><span class=mr-1.5>←</span><span>SoB weekly report!</span></a><a class="block-hover-mask ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline" href=https://jaoleal.github.io/zola-blog/posts/vinteum-challenge/><span>I did the challenge(again)!</span><span class=ml-1.5>→</span></a></nav></article></main><footer class="mx-auto flex max-w-3xl flex-wrap items-center px-8 py-4 text-sm opacity-60"><div class="mr-auto basis-full lg:basis-1/2">© 2024 <a class=link href=https://jaoleal.github.io/zola-blog>João Leal</a></div><div class="flex basis-full lg:basis-1/2 lg:justify-end"><a class="link mr-6 lg:ml-6" href=https://www.getzola.org/ rel=noopener target=_blank>Powered by Zola</a><a class=link href=https://github.com/st1020/kita rel=noopener target=_blank>✎ Kita</a></div></footer>